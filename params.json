{"name":"Wings","tagline":"Android library for silently sharing photos to multiple endpoints","body":"Wings is an Android library for silently sharing photos to an extensible set of endpoints. The currently supported endpoints include:\r\n\r\n* Dropbox\r\n* Facebook\r\n* Google Cloud Print\r\n\r\nLinking user accounts, selecting destinations, as well as the retry logic to ensure delivery are all handled by Wings. The application integrates with Wings APIs that are non-specific to the underlying endpoints, and Wings will take care of the rest. Wings also defines an interface for the application to add additional endpoints, so consider the above list easily extensible.\r\n\r\nWings started off as a component in [Flying PhotoBooth](https://play.google.com/store/apps/details?id=com.groundupworks.flyingphotobooth) and [Party PhotoBooth](https://play.google.com/store/apps/details?id=com.groundupworks.partyphotobooth), and has helped us publish photos reliably and efficiently over the years. We are now open-sourcing it because posting a photo should be easy, while integrating with native SDKs of the ever-growing number of service providers is anything but easy... so we hope Wings will take care of that part for you, and should you find yourself building new endpoints, make a pull request and add to the list!\r\n\r\n## Adding Wings to your project\r\n\r\nThe Wings library builds multiple artifactsâ€”the core **wings.aar** and an AAR per endpoint, such as **wings-dropbox.aar**. You will only need to include the core library and the endpoints applicable to your application. The recommended way to integrate with Wings is to add the source to your application, but you can also add the AARs instead. The following instructions assume you are building with Gradle in Android Studio.\r\n\r\n### Adding Wings as source\r\n\r\nClone the Wings source.\r\n\r\n```\r\n$ git clone https://github.com/groundupworks/wings.git\r\n```\r\n\r\nOr if you use [Submodules](http://git-scm.com/book/en/v2/Git-Tools-Submodules), add Wings as a submodule to your project.\r\n\r\n```\r\n$ git submodule add https://github.com/groundupworks/wings.git\r\n```\r\n\r\nThen from your project in Android Studio, **Import Module...** from the root **wings** folder, and you should see the list of all Wings modules. Select **wings** and the endpoints you want your application to share to. Complete the import, and your project's **settings.gradle** should now contain the Wings modules.\r\n\r\nNow you need to add these modules as dependencies in your application's **build.gradle**.\r\n\r\n```\r\ndependencies {\r\n    compile project(':wings')\r\n    compile project(':wings-dropbox')     // If applicable\r\n    compile project(':wings-facebook')    // If applicable\r\n    compile project(':wings-gcp')         // If applicable\r\n}\r\n```\r\n\r\nRebuild your project, and say a prayer to the Gradle gods.\r\n\r\n## Setting up the endpoints\r\n\r\nYou will find **values/application.xml** in some of the endpoint modules. This is where you specify credentials and configurations specific to your application. Take the Facebook endpoint for example, the following keys need to be overridden by your application.\r\n\r\n```\r\n<!-- Your app id from Facebook -->\r\n<string name=\"wings_facebook__app_id\">null</string>\r\n\r\n<!-- The name of the default album to be created for storing photos -->\r\n<string name=\"wings_facebook__app_album_default_name\">null</string>\r\n```\r\n\r\nYou will need to sign up as a [Facebook Developer](https://developers.facebook.com) and register your application to obtain an app ID, then map that value to a string resource in your application with the key `wings_facebook__app_id`. The default album name will be overridden the same way. Note that the values you specify in your application will override the `null` specified in the library, so you should not directly modify **application.xml** in Wings.\r\n\r\nThe Dropbox endpoint will be [a similar story](https://www.dropbox.com/developers). The integration instructions from the service providers may ask you to add stuff to your **AndroidManifest.xml**, you can skip that when using Wings, because the endpoint AAR will take care of that for you by merging its manifest. All you need to do is override the values in each **application.xml**.\r\n\r\n## Using the Wings APIs\r\n\r\n### Initializing Wings\r\n\r\nWings need to be initialized in the `Application#onCreate()`.\r\n\r\n```\r\nIWingsModule module = new Wings.DefaultModule(this, looper, logger);\r\nWings.init(module, FacebookEndpoint.class, DropboxEndpoint.class, GoogleCloudPrintEndpoint.class);\r\n```\r\n\r\nThe `looper` is used to run background tasks and the `logger` implements `IWingsLogger`. All endpoint classes  used in your application should be passed to `Wings#init()`.\r\n\r\n### Linking a user account\r\n\r\nTo share to a user's account, the user will *link* with a sharing service, which means authenticating followed by authorizing the appropriate level of access, then specifying the destination for the shared content. All of this OAuth happiness, including UI, is handled by Wings. The application is responsible for initiating the linking process from an `Activity` or a `Fragment`, as in this Facebook example.\r\n\r\n```\r\nWings.getEndpoint(FacebookEndpoint.class).startLinkRequest(activity, fragment);\r\n```\r\n\r\nIn that same `Activity` or `Fragment`, the following must be called in the `onResume()` and `onActivityResult()`  for linking to complete.\r\n\r\n```\r\nWings.getEndpoint(FacebookEndpoint.class).onResumeImpl();\r\n```\r\n\r\n```\r\nWings.getEndpoint(FacebookEndpoint.class).onActivityResultImpl(activity, fragment, requestCode, resultCode, data);\r\n```\r\n\r\n### Subscribing to link state changes\r\n\r\nEach endpoint emits its own `LinkEvent` to the [Otto](http://square.github.io/otto/) `Bus`. A subscriber will receive the event at the time of subscription, and whenever the link state of that endpoint changes, until unsubscribed.\r\n\r\nTo listen to link state changes of the Facebook and Dropbox endpoints, implement the following subscription methods in your `Activity` or `Fragment`, then call `Wings#subscribe()` and `Wings#unsubscribe()` in your `onResume()` and `onPause()` respectively. This will ensure your UI is initialized with the correct state, and properly updates with each link state change.\r\n\r\n```\r\n@Subscribe\r\npublic void handleLinkEvent(FacebookEndpoint.LinkEvent event) {\r\n    // Update Facebook link state UI with event.isLinked().\r\n}\r\n\r\n@Subscribe\r\npublic void handleLinkEvent(DropboxEndpoint.LinkEvent event) {\r\n    // Update Dropbox link state UI with event.isLinked().\r\n}\r\n```\r\n\r\n### Sharing a photo\r\n\r\nAfter confirming that a `WingsEndpoint#isLinked()`, you want to start sharing photos to that endpoint. This is done by calling `Wings#share()`, which internally creates a share request record in a database and triggers a background service to process that request. If the device has no connectivity at the moment, a retry will be scheduled according to a retry policy that waits longer and longer between subsequent retries should the request keep failing. The current implementation calculates retry intervals based on the Fibonacci sequence and gives up on records that has failed for more than two days.\r\n\r\nThe following call will create a share request to post a photo to the user's Facebook profile. A notification will appear on the status bar once the photo has been shared.\r\n\r\n```\r\nWings.share(filePath, FacebookEndpoint.DestinationId.PROFILE, FacebookEndpoint.class);\r\n```\r\n\r\n## Creating a new endpoint\r\n\r\nIf you intend to create a new endpoint, it'd probably be a good idea to fork the Git repo instead of cloning it. Then create a concrete implementation of `WingsEndpoint`, and you'll have a new endpoint. The best way to start is to look at how an existing endpoint implements all the interfaces. Once the new endpoint is created, remember to pass it to `Wings#init()` and consider submitting a pull request from your fork :)","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}