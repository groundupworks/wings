<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Wings by groundupworks</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Wings</h1>
          <h2>Android library for silently sharing photos to multiple endpoints</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/groundupworks/wings/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/groundupworks/wings/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/groundupworks/wings" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <p>Wings is an Android library for silently sharing photos to an extensible set of endpoints. The currently supported endpoints include:</p>

<ul>
<li>Dropbox</li>
<li>Facebook</li>
<li>Google Cloud Print</li>
</ul>

<p>Linking user accounts, selecting destinations, as well as the retry logic to ensure delivery are all handled by Wings. The application integrates with Wings APIs that are non-specific to the underlying endpoints, and Wings will take care of the rest. Wings also defines an interface for the application to add additional endpoints, so consider the above list easily extensible.</p>

<p>Wings started off as a component in <a href="https://play.google.com/store/apps/details?id=com.groundupworks.flyingphotobooth">Flying PhotoBooth</a> and <a href="https://play.google.com/store/apps/details?id=com.groundupworks.partyphotobooth">Party PhotoBooth</a>, and has helped us publish photos reliably and efficiently over the years. We are now open-sourcing it because posting a photo should be easy, while integrating with native SDKs of the ever-growing number of service providers is anything but easy... so we hope Wings will take care of that part for you, and should you find yourself building new endpoints, make a pull request and add to the list!</p>

<h2>
<a id="adding-wings-to-your-project" class="anchor" href="#adding-wings-to-your-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding Wings to your project</h2>

<p>The Wings library builds multiple artifactsâ€”the core <strong>wings.aar</strong> and an AAR per endpoint, such as <strong>wings-dropbox.aar</strong>. You will only need to include the core library and the endpoints applicable to your application. The recommended way to integrate with Wings is to add the source to your application, but you can also add the AARs instead. The following instructions assume you are building with Gradle in Android Studio.</p>

<h3>
<a id="adding-wings-as-source" class="anchor" href="#adding-wings-as-source" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding Wings as source</h3>

<p>Clone the Wings source.</p>

<pre><code>$ git clone https://github.com/groundupworks/wings.git
</code></pre>

<p>Or if you use <a href="http://git-scm.com/book/en/v2/Git-Tools-Submodules">Submodules</a>, add Wings as a submodule to your project.</p>

<pre><code>$ git submodule add https://github.com/groundupworks/wings.git
</code></pre>

<p>Then from your project in Android Studio, <strong>Import Module...</strong> from the root <strong>wings</strong> folder, and you should see the list of all Wings modules. Select <strong>wings</strong> and the endpoints you want your application to share to. Complete the import, and your project's <strong>settings.gradle</strong> should now contain the Wings modules.</p>

<p>Now you need to add these modules as dependencies in your application's <strong>build.gradle</strong>.</p>

<pre><code>dependencies {
    compile project(':wings')
    compile project(':wings-dropbox')     // If applicable
    compile project(':wings-facebook')    // If applicable
    compile project(':wings-gcp')         // If applicable
}
</code></pre>

<p>Rebuild your project, and say a prayer to the Gradle gods.</p>

<h2>
<a id="setting-up-the-endpoints" class="anchor" href="#setting-up-the-endpoints" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up the endpoints</h2>

<p>You will find <strong>values/application.xml</strong> in some of the endpoint modules. This is where you specify credentials and configurations specific to your application. Take the Facebook endpoint for example, the following keys need to be overridden by your application.</p>

<pre><code>&lt;!-- Your app id from Facebook --&gt;
&lt;string name="wings_facebook__app_id"&gt;null&lt;/string&gt;

&lt;!-- The name of the default album to be created for storing photos --&gt;
&lt;string name="wings_facebook__app_album_default_name"&gt;null&lt;/string&gt;
</code></pre>

<p>You will need to sign up as a <a href="https://developers.facebook.com">Facebook Developer</a> and register your application to obtain an app ID, then map that value to a string resource in your application with the key <code>wings_facebook__app_id</code>. The default album name will be overridden the same way. Note that the values you specify in your application will override the <code>null</code> specified in the library, so you should not directly modify <strong>application.xml</strong> in Wings.</p>

<p>The Dropbox endpoint will be <a href="https://www.dropbox.com/developers">a similar story</a>. The integration instructions from the service providers may ask you to add stuff to your <strong>AndroidManifest.xml</strong>, you can skip that when using Wings, because the endpoint AAR will take care of that for you by merging its manifest. All you need to do is override the values in each <strong>application.xml</strong>.</p>

<h2>
<a id="using-the-wings-apis" class="anchor" href="#using-the-wings-apis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using the Wings APIs</h2>

<h3>
<a id="initializing-wings" class="anchor" href="#initializing-wings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Initializing Wings</h3>

<p>Wings need to be initialized in the <code>Application#onCreate()</code>.</p>

<pre><code>IWingsModule module = new Wings.DefaultModule(this, looper, logger);
Wings.init(module, FacebookEndpoint.class, DropboxEndpoint.class, GoogleCloudPrintEndpoint.class);
</code></pre>

<p>The <code>looper</code> is used to run background tasks and the <code>logger</code> implements <code>IWingsLogger</code>. All endpoint classes  used in your application should be passed to <code>Wings#init()</code>.</p>

<h3>
<a id="linking-a-user-account" class="anchor" href="#linking-a-user-account" aria-hidden="true"><span class="octicon octicon-link"></span></a>Linking a user account</h3>

<p>To share to a user's account, the user will <em>link</em> with a sharing service, which means authenticating followed by authorizing the appropriate level of access, then specifying the destination for the shared content. All of this OAuth happiness, including UI, is handled by Wings. The application is responsible for initiating the linking process from an <code>Activity</code> or a <code>Fragment</code>, as in this Facebook example.</p>

<pre><code>Wings.getEndpoint(FacebookEndpoint.class).startLinkRequest(activity, fragment);
</code></pre>

<p>In that same <code>Activity</code> or <code>Fragment</code>, the following must be called in the <code>onResume()</code> and <code>onActivityResult()</code>  for linking to complete.</p>

<pre><code>Wings.getEndpoint(FacebookEndpoint.class).onResumeImpl();
</code></pre>

<pre><code>Wings.getEndpoint(FacebookEndpoint.class).onActivityResultImpl(activity, fragment, requestCode, resultCode, data);
</code></pre>

<h3>
<a id="subscribing-to-link-state-changes" class="anchor" href="#subscribing-to-link-state-changes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Subscribing to link state changes</h3>

<p>Each endpoint emits its own <code>LinkEvent</code> to the <a href="http://square.github.io/otto/">Otto</a> <code>Bus</code>. A subscriber will receive the event at the time of subscription, and whenever the link state of that endpoint changes, until unsubscribed.</p>

<p>To listen to link state changes of the Facebook and Dropbox endpoints, implement the following subscription methods in your <code>Activity</code> or <code>Fragment</code>, then call <code>Wings#subscribe()</code> and <code>Wings#unsubscribe()</code> in your <code>onResume()</code> and <code>onPause()</code> respectively. This will ensure your UI is initialized with the correct state, and properly updates with each link state change.</p>

<pre><code>@Subscribe
public void handleLinkEvent(FacebookEndpoint.LinkEvent event) {
    // Update Facebook link state UI with event.isLinked().
}

@Subscribe
public void handleLinkEvent(DropboxEndpoint.LinkEvent event) {
    // Update Dropbox link state UI with event.isLinked().
}
</code></pre>

<h3>
<a id="sharing-a-photo" class="anchor" href="#sharing-a-photo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sharing a photo</h3>

<p>After confirming that a <code>WingsEndpoint#isLinked()</code>, you want to start sharing photos to that endpoint. This is done by calling <code>Wings#share()</code>, which internally creates a share request record in a database and triggers a background service to process that request. If the device has no connectivity at the moment, a retry will be scheduled according to a retry policy that waits longer and longer between subsequent retries should the request keep failing. The current implementation calculates retry intervals based on the Fibonacci sequence and gives up on records that has failed for more than two days.</p>

<p>The following call will create a share request to post a photo to the user's Facebook profile. A notification will appear on the status bar once the photo has been shared.</p>

<pre><code>Wings.share(filePath, FacebookEndpoint.DestinationId.PROFILE, FacebookEndpoint.class);
</code></pre>

<h2>
<a id="creating-a-new-endpoint" class="anchor" href="#creating-a-new-endpoint" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating a new endpoint</h2>

<p>If you intend to create a new endpoint, it'd probably be a good idea to fork the Git repo instead of cloning it. Then create a concrete implementation of <code>WingsEndpoint</code>, and you'll have a new endpoint. The best way to start is to look at how an existing endpoint implements all the interfaces. Once the new endpoint is created, remember to pass it to <code>Wings#init()</code> and consider submitting a pull request from your fork :)</p>
        </section>

        <footer>
          Wings is maintained by <a href="https://github.com/groundupworks">groundupworks</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>